<!doctype html><html lang=en><head><title>Raspberry Pi Kubernetes Cluster - Part 4 · Learn, Converse, Share</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Jason Meridth"><meta name=description content="Raspberry Pi Kubenetes Cluster - Part 1
Raspberry Pi Kubenetes Cluster - Part 2
Raspberry Pi Kubenetes Cluster - Part 3
Raspberry Pi Kubenetes Cluster - Part 4
Howdy again.
In this post I&rsquo;m going to show you how to create a docker image to run on ARM architecture and also how to deploy it and view it.
To start please view my basic flask application called fl8 here
If you&rsquo;d like to clone and use it:
git clone git@github.com:meridth/fl8.git && cd fl8

  ARM docker image
  
    
    Link to heading
  

First we need to learn about QEMU

  What is QEMU and QEMU installation
  
    
    Link to heading
  

QEMU (Quick EMUlator) is an Open-Source hosted hypervisor, i.e. an hypervisor running on a OS just as other computer programs, which performs hardware virtualization. QEMU emulates CPUs of several architectures, e.g. x86, PPC, ARM and SPARC. It allows the execution of non-native target executables emulating the native execution and, as we require in this case, the cross-building process."><meta name=keywords content="jason meridth,meridth,jm,software developer"><meta name=fediverse:creator content><meta name=twitter:card content="summary"><meta name=twitter:title content="Raspberry Pi Kubernetes Cluster - Part 4"><meta name=twitter:description content="Raspberry Pi Kubenetes Cluster - Part 1
Raspberry Pi Kubenetes Cluster - Part 2
Raspberry Pi Kubenetes Cluster - Part 3
Raspberry Pi Kubenetes Cluster - Part 4
Howdy again.
In this post I’m going to show you how to create a docker image to run on ARM architecture and also how to deploy it and view it.
To start please view my basic flask application called fl8 here
If you’d like to clone and use it:
git clone git@github.com:meridth/fl8.git && cd fl8 ARM docker image Link to heading First we need to learn about QEMU
What is QEMU and QEMU installation Link to heading QEMU (Quick EMUlator) is an Open-Source hosted hypervisor, i.e. an hypervisor running on a OS just as other computer programs, which performs hardware virtualization. QEMU emulates CPUs of several architectures, e.g. x86, PPC, ARM and SPARC. It allows the execution of non-native target executables emulating the native execution and, as we require in this case, the cross-building process."><meta property="og:url" content="http://jmeridth.com/posts/raspberry-pi-kubernetes-cluster-part-4/"><meta property="og:site_name" content="Learn, Converse, Share"><meta property="og:title" content="Raspberry Pi Kubernetes Cluster - Part 4"><meta property="og:description" content="Raspberry Pi Kubenetes Cluster - Part 1
Raspberry Pi Kubenetes Cluster - Part 2
Raspberry Pi Kubenetes Cluster - Part 3
Raspberry Pi Kubenetes Cluster - Part 4
Howdy again.
In this post I’m going to show you how to create a docker image to run on ARM architecture and also how to deploy it and view it.
To start please view my basic flask application called fl8 here
If you’d like to clone and use it:
git clone git@github.com:meridth/fl8.git && cd fl8 ARM docker image Link to heading First we need to learn about QEMU
What is QEMU and QEMU installation Link to heading QEMU (Quick EMUlator) is an Open-Source hosted hypervisor, i.e. an hypervisor running on a OS just as other computer programs, which performs hardware virtualization. QEMU emulates CPUs of several architectures, e.g. x86, PPC, ARM and SPARC. It allows the execution of non-native target executables emulating the native execution and, as we require in this case, the cross-building process."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-12-28T10:35:23+00:00"><meta property="article:modified_time" content="2018-12-28T10:35:23+00:00"><meta property="article:tag" content="Kubernetes"><meta property="article:tag" content="Raspberrypi"><link rel=canonical href=http://jmeridth.com/posts/raspberry-pi-kubernetes-cluster-part-4/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.60f552a2c0452fcc0254c54f21c3e0728460c1ae85f97a9c35833a222ef8b884.css integrity="sha256-YPVSosBFL8wCVMVPIcPgcoRgwa6F+XqcNYM6Ii74uIQ=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/css_dark_mode_gist_embed_code.min.8cc090c81a341bd24e5a85fe1ebaef4cfbb86849618d2012f7198b6a36a7e5e6.css integrity="sha256-jMCQyBo0G9JOWoX+HrrvTPu4aElhjSAS9xmLajan5eY=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/favicon.ico sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-dark"><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=http://jmeridth.com/>Learn, Converse, Share
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=/projects/>Projects</a></li><li class=navigation-item><a class=navigation-link href=/talks/>Talks</a></li><li class=navigation-item><a class=navigation-link href=/contact/>Contact Me</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=http://jmeridth.com/posts/raspberry-pi-kubernetes-cluster-part-4/>Raspberry Pi Kubernetes Cluster - Part 4</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2018-12-28T10:35:23Z>December 28, 2018
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
2-minute read</span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/kubernetes/>Kubernetes</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/raspberrypi/>Raspberrypi</a></span></div></div></header><div class=post-content><p><a href=/posts/raspberry-pi-kubernetes-cluster-part-1>Raspberry Pi Kubenetes Cluster - Part 1</a></p><p><a href=/posts/raspberry-pi-kubernetes-cluster-part-2>Raspberry Pi Kubenetes Cluster - Part 2</a></p><p><a href=/posts/raspberry-pi-kubernetes-cluster-part-3>Raspberry Pi Kubenetes Cluster - Part 3</a></p><p><a href=/posts/raspberry-pi-kubernetes-cluster-part-4>Raspberry Pi Kubenetes Cluster - Part 4</a></p><p>Howdy again.</p><p>In this post I&rsquo;m going to show you how to create a docker image to run on ARM architecture and also how to deploy it and view it.</p><p>To start please view my basic flask application called fl8 <a href=https://github.com/meridth/fl8 class=external-link target=_blank rel=noopener>here</a></p><p>If you&rsquo;d like to clone and use it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone git@github.com:meridth/fl8.git <span class=o>&amp;&amp;</span> <span class=nb>cd</span> fl8
</span></span></code></pre></div><h2 id=arm-docker-image>ARM docker image
<a class=heading-link href=#arm-docker-image><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>First we need to learn about QEMU</p><h3 id=what-is-qemu-and-qemu-installation>What is QEMU and QEMU installation
<a class=heading-link href=#what-is-qemu-and-qemu-installation><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>QEMU (Quick EMUlator) is an Open-Source hosted hypervisor, i.e. an hypervisor running on a OS just as other computer programs, which performs hardware virtualization. QEMU emulates CPUs of several architectures, e.g. x86, PPC, ARM and SPARC. It allows the execution of non-native target executables emulating the native execution and, as we require in this case, the cross-building process.</p><h3 id=base-docker-image-that-includes-qemu>Base Docker image that includes QEMU
<a class=heading-link href=#base-docker-image-that-includes-qemu><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>Please open the <code>Dockerfile.arm</code> and notice the first line: <code>FROM hypriot/rpi-alpine</code>. This is a base image that includes the target qemu statically linked executable, <em>qemu-arm-static</em> in this case. I chose <code>hypriot/rpi-alpine</code> because the alpine base images are much smaller than other base images.</p><h3 id=register-qemu-in-the-build-agent>Register QEMU in the build agent
<a class=heading-link href=#register-qemu-in-the-build-agent><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>To add QEMU in the build agent there is a specific Docker Image performing what we need, so just run in your command line:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker run --rm --privileged multiarch/qemu-user-static:register --reset
</span></span></code></pre></div><h3 id=build-image>Build image
<a class=heading-link href=#build-image><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker build -f ./Dockerfile.arm -t meridth/rpi-fl8 .
</span></span></code></pre></div><p>And voila! You now have an image that will run on Raspberry Pis.</p><h2 id=deployment-and-service>Deployment and Service
<a class=heading-link href=#deployment-and-service><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p><code>/.run-rpi.sh</code> is my script where I run a Kubernetes deployment with 3 replicas and a Kubernetes service. Please read <code>fl8-rpi-deployment.yml</code> and <code>fl8-rpi-service.yml</code>. They are only different from the other deployment and service files by labels. Labels are key/vaule pairs that can be used by selectors later.</p><p>The deployment will pull my image from <code>meridth/rpi-fl8</code> on dockerhub. If you have uploaded your docker image somewhere you can change the deployment file to pull that image instead.</p><h2 id=viewing-application>Viewing application
<a class=heading-link href=#viewing-application><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods
</span></span></code></pre></div><p>Choose a pod to create the port forwarding ssh tunnel.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl port-forward <span class=o>[</span>pod-name<span class=o>]</span> <span class=o>[</span>app-port<span class=o>]</span>:<span class=o>[</span>app-port<span class=o>]</span>
</span></span></code></pre></div><p>Example: <code>kubectl port-forward rpi-fl8-5d84dd8ff6-d9tgz 5010:5010</code></p><p>The final result when you go to <code>http://localhost:5010</code> in a browser.</p><p><img src=/img/kubernetes_cluster/port_forward.png alt="port forward result"></p><p>Hope this helps someone else. Cheers.</p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2007 -
2025
Jason Meridth
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-4W46VMK7DQ"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4W46VMK7DQ")</script></body></html>