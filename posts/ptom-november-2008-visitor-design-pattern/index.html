<!doctype html><html lang=en><head><title>PTOM - November 2008 - Visitor Design Pattern · Learn, Converse, Share
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="JM (Jason Meridth)"><meta name=description content='Definition Link to heading Visitor Design Pattern - _"_Represent an operation to be performed on the elements of an object structure. Visitor lets you define a new operation without changing the classes of the elements on which it operates. " dofactory.com Another term you may hear when working with the Visitor Pattern, is Double Dispatch. How that applies to Visitor is that the accept method takes a visitor instance, which in turn has a visit method that takes the concrete instance (aka &ldquo;this&rdquo;).'><meta name=keywords content="jason meridth,meridth,jm,software developer"><meta name=twitter:card content="summary"><meta name=twitter:title content="PTOM - November 2008 - Visitor Design Pattern"><meta name=twitter:description content='Definition Link to heading Visitor Design Pattern - _"_Represent an operation to be performed on the elements of an object structure. Visitor lets you define a new operation without changing the classes of the elements on which it operates. " dofactory.com Another term you may hear when working with the Visitor Pattern, is Double Dispatch. How that applies to Visitor is that the accept method takes a visitor instance, which in turn has a visit method that takes the concrete instance (aka “this”).'><meta property="og:url" content="http://jmeridth.com/posts/ptom-november-2008-visitor-design-pattern/"><meta property="og:site_name" content="Learn, Converse, Share"><meta property="og:title" content="PTOM - November 2008 - Visitor Design Pattern"><meta property="og:description" content='Definition Link to heading Visitor Design Pattern - _"_Represent an operation to be performed on the elements of an object structure. Visitor lets you define a new operation without changing the classes of the elements on which it operates. " dofactory.com Another term you may hear when working with the Visitor Pattern, is Double Dispatch. How that applies to Visitor is that the accept method takes a visitor instance, which in turn has a visit method that takes the concrete instance (aka “this”).'><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2008-11-30T21:15:00-06:00"><meta property="article:modified_time" content="2008-11-30T21:15:00-06:00"><link rel=canonical href=http://jmeridth.com/posts/ptom-november-2008-visitor-design-pattern/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.38c4552ac40f9ae3408bad40358f654ebd8804412fe74ed56f2d6c8a7af82dd3.css integrity="sha256-OMRVKsQPmuNAi61ANY9lTr2IBEEv507Vby1sinr4LdM=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/css_dark_mode_gist_embed_code.min.5f4f026828cc544c1497785bca628b4ddc8a6c1f154cc2b83c87a13ceaff419a.css integrity="sha256-X08CaCjMVEwUl3hbymKLTdyKbB8VTMK4PIehPOr/QZo=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-dark"><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=http://jmeridth.com/>Learn, Converse, Share
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=/projects/>Projects</a></li><li class=navigation-item><a class=navigation-link href=/contact/>Contact me</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=http://jmeridth.com/posts/ptom-november-2008-visitor-design-pattern/>PTOM - November 2008 - Visitor Design Pattern</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2008-11-30T21:15:00-06:00>November 30, 2008
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
3-minute read</span></div></div></header><div class=post-content><h2 id=definition>Definition
<a class=heading-link href=#definition><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Visitor Design Pattern - _"_Represent an operation to be performed on the elements of an object structure. Visitor lets you define a new operation without changing the classes of the elements on which it operates. " <a href=http://dofactory.com/Patterns/PatternVisitor.aspx class=external-link target=_blank rel=noopener>dofactory.com</a> Another term you may hear when working with the Visitor Pattern, is <a href=http://en.wikipedia.org/wiki/Double_dispatch class=external-link target=_blank rel=noopener>Double Dispatch</a>. How that applies to Visitor is that the accept method takes a visitor instance, which in turn has a visit method that takes the concrete instance (aka &ldquo;this&rdquo;). Inside the visitor visit method is where the core of the visitor pattern occurs. It is where you can extend the concrete class without actually editing the concrete class. <em><img alt=image src=//lostechies.com/jasonmeridth/files/2011/03/image_thumb.png></em></p><h2 id=open-closed-principle-ocp>Open Closed Principle (OCP)
<a class=heading-link href=#open-closed-principle-ocp><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>&ldquo;&mldr;using the visitor pattern helps conformance with the open/closed principle.&rdquo; (<a href=http://en.wikipedia.org/wiki/Visitor_pattern class=external-link target=_blank rel=noopener>Wikipedia</a>) The <a href=/blogs/joe_ocampo/archive/2008/03/21/ptom-the-open-closed-principle.aspx>Open/Closed Principle</a> is that &ldquo;a class is open for extension, closed for modification&rdquo;. (<a href=http://en.wikipedia.org/wiki/Open_Closed_Principle class=external-link target=_blank rel=noopener>Thank you Mr. Meyer</a>) I recently used the Visitor pattern inline with usage of a State Pattern. The Visitor would be able to determine, based on it&rsquo;s algorithms, which was changing regularly by the needs of the end user, whether an object could move to the next state in the machine. Adhering to our theme, a coffee shop, I decided to generat a paycheck stub . My C# example is showing how to report the coffee shop employees earned wages, deductions via sick days and number of vacation days taken:</p><h2 id=c-code>C# Code
<a class=heading-link href=#c-code><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Test Firsts (NUnit): <script src=https://gist.github.com/jmeridth/1067984.js></script>I have two test fixtures, one for hourly employees and one for full-time employees. Hopefully, via my rough version of Behavior Driven Development (BDD), you can read my tests without any problems. Implementation: <script src=https://gist.github.com/jmeridth/1067988.js></script>Please remember, this is &ldquo;blog friendly&rdquo; code. I would definitely break the visitor class apart into a few classes (i.e., WageCalculator, SickPayDeductionCalculator, etc).</p><h2 id=ruby-code>Ruby Code
<a class=heading-link href=#ruby-code><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Please understand that I&rsquo;m a Ruby newbie and I&rsquo;m petty sure there is a more &ldquo;Ruby-ish&rdquo; way to do this.__I&rsquo;ve recently been placed on a Ruby team and I&rsquo;m making the transition from the static language mind-set to the dynamic language mind-set. I do understand with mix-ins you can dynamically add functionality to a class based on context, so visitor may not be necessary at all. I&rsquo;m still grokking that concept. I still believe in the Open/Closed principle, but it may be moot with dynamic languages. It&rsquo;s actually very exciting being a newbie developer again. It feeds my insatiable need to learn. Test (Using RSpec): <script src=https://gist.github.com/jmeridth/1067994.js></script>Implementation: <script src=https://gist.github.com/jmeridth/1067996.js></script></p><h2 id=what-i-learned>What I Learned
<a class=heading-link href=#what-i-learned><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>I personally use the strategy pattern more than any other pattern. That is why I chose this pattern. So I could understand it better. A good example I saw recently, using lambdas and all the new .NET features was <a href=http://mokhan.ca/blog/CommentView,guid,0480cc5f-54e4-452f-b0d5-661f0a8289d7.aspx#commentstart class=external-link target=_blank rel=noopener>Chad&rsquo;s comment</a> (<a href=http://pastie.org/245770 class=external-link target=_blank rel=noopener>pastie.org</a>) on <a href=http://mokhan.ca/blog/2008/08/01/Recursive+Command.aspx class=external-link target=_blank rel=noopener>Mo&rsquo;s Recursive Command Post</a> Hope this helps someone understand the Visitor Design Pattern better.</p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2007 -
2024
JM (Jason Meridth)
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-4W46VMK7DQ"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4W46VMK7DQ")</script></body></html>