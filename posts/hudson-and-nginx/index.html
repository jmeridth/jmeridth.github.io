<!doctype html><html lang=en><head><title>Hudson and Nginx · Learn, Converse, Share
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="JM (Jason Meridth)"><meta name=description content="UPDATE: I left HTTP Auth in place via Nginx and removed security from my Hudson instance. This works for me because I don&rsquo;t need the Hudson security. Every developer should be able to manage the CI server. I&rsquo;m just trying to prevent external access to the dashboard.
I&rsquo;ve been having fun trying to figure out how to block a user&rsquo;s ability of going to http://mydomain:8080 and bypassing my 80 to 443 redirect and htpasswd HTTP basic authentication."><meta name=keywords content="jason meridth,meridth,jm,software developer"><meta name=twitter:card content="summary"><meta name=twitter:title content="Hudson and Nginx"><meta name=twitter:description content="UPDATE: I left HTTP Auth in place via Nginx and removed security from my Hudson instance. This works for me because I don’t need the Hudson security. Every developer should be able to manage the CI server. I’m just trying to prevent external access to the dashboard.
I’ve been having fun trying to figure out how to block a user’s ability of going to http://mydomain:8080 and bypassing my 80 to 443 redirect and htpasswd HTTP basic authentication."><meta property="og:url" content="http://jmeridth.com/posts/hudson-and-nginx/"><meta property="og:site_name" content="Learn, Converse, Share"><meta property="og:title" content="Hudson and Nginx"><meta property="og:description" content="UPDATE: I left HTTP Auth in place via Nginx and removed security from my Hudson instance. This works for me because I don’t need the Hudson security. Every developer should be able to manage the CI server. I’m just trying to prevent external access to the dashboard.
I’ve been having fun trying to figure out how to block a user’s ability of going to http://mydomain:8080 and bypassing my 80 to 443 redirect and htpasswd HTTP basic authentication."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2009-02-12T04:46:00-06:00"><meta property="article:modified_time" content="2009-02-12T04:46:00-06:00"><link rel=canonical href=http://jmeridth.com/posts/hudson-and-nginx/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.38c4552ac40f9ae3408bad40358f654ebd8804412fe74ed56f2d6c8a7af82dd3.css integrity="sha256-OMRVKsQPmuNAi61ANY9lTr2IBEEv507Vby1sinr4LdM=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/css_dark_mode_gist_embed_code.min.5f4f026828cc544c1497785bca628b4ddc8a6c1f154cc2b83c87a13ceaff419a.css integrity="sha256-X08CaCjMVEwUl3hbymKLTdyKbB8VTMK4PIehPOr/QZo=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-dark"><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=http://jmeridth.com/>Learn, Converse, Share
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=/projects/>Projects</a></li><li class=navigation-item><a class=navigation-link href=/contact/>Contact me</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=http://jmeridth.com/posts/hudson-and-nginx/>Hudson and Nginx</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2009-02-12T04:46:00-06:00>February 12, 2009
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
2-minute read</span></div></div></header><div class=post-content><p>UPDATE: I left HTTP Auth in place via Nginx and removed security from my Hudson instance. This works for me because I don&rsquo;t need the Hudson security. Every developer should be able to manage the CI server. I&rsquo;m just trying to prevent external access to the dashboard.</p><p>I&rsquo;ve been having fun trying to figure out how to block a user&rsquo;s ability of going to <a href=http://mydomain:8080 class=external-link target=_blank rel=noopener>http://mydomain:8080</a> and bypassing my 80 to 443 redirect and htpasswd HTTP basic authentication. I even went as far as removing Nginx and installing Apache. According to the Hudson site, we can use <a href=http://hudson.gotdns.com/wiki/display/HUDSON/Apache+frontend+for+security class=external-link target=_blank rel=noopener>Apache to do this</a>. Either I&rsquo;m not smart enough or web pages like this reminded me why I hate the Java Enterprise stack as much as I do. Talk about installation obfuscation. My problem exists because the Tomcat instance running the hudson war file uses <a href=http://tomcat.apache.org/tomcat-5.5-doc/config/ajp.html#Standard%20Implementation class=external-link target=_blank rel=noopener>Apache JServe Protocol</a> (AJP) and will allow direct access on whatever port you used (default 8080). This is even if you proxy_pass to 8080 from 443 (SSL) or 80 (Web). Through testing and research it seems that <a href=http://www.ruby-forum.com/topic/157269#693042 class=external-link target=_blank rel=noopener>Nginx does not have a solution for this</a>. I can&rsquo;t allow access to my Hudson instance from external users. I have a self-signed certificate and a .htpasswd file to protect the instance, but is all useless is someone could just type in <a href=http://mydomain.com:8080 class=external-link target=_blank rel=noopener>http://mydomain.com:8080</a>. I want that redirected to <a href=https://mydomain.com class=external-link target=_blank rel=noopener>https://mydomain.com</a> which will then proxy internally to <a href=http://127.0.0.1:8080 class=external-link target=_blank rel=noopener>http://127.0.0.1:8080</a>. I didn&rsquo;t want to fight this, so I just used iptables (linux firewall) to block external requests on port 8080 but allow internal requests to 8080. Here is the entry in my iptables file:</p><pre><code># Deny HTTP requests to port 8080 externally but allow internally
-A INPUT -i eth0 -p tcp -m tcp --dport 8080 -j REJECT
</code></pre><p>I only allow access to my server via 80 (web), 443 (ssl) and my ssh port (I&rsquo;m not telling). This works for now, but I&rsquo;m experiencing another weird issue. I follow the Nginx way of using HTTP basic authentication:</p><pre><code>location  /  {
 auth_basic            &quot;Restricted&quot;;
 auth_basic_user_file  conf/htpasswd;
}
</code></pre><p>If the user listed in the <a href=http://httpd.apache.org/docs/2.0/programs/htpasswd.html class=external-link target=_blank rel=noopener>htpasswd</a> file is also a registered user on the Hudson instance (through the Hudson UI) then the HTTP basic authentication will work. If they are in the htpasswd file but not registered with Hudson, it fails with a HTTP 401 (Unauthorized). Why would the HTTP basic authentication be &ldquo;tunneled&rdquo; through to Hudson? I&rsquo;ll update this post once I figure it out.</p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2007 -
2024
JM (Jason Meridth)
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-4W46VMK7DQ"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4W46VMK7DQ")</script></body></html>