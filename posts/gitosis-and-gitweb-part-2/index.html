<!doctype html><html lang=en><head><meta charset=utf-8><title>Gitosis and Gitweb - Part 2 - Add Projects and Contributors | JM (Jason Meridth)</title><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.96.0"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=keywords content="git,gitosis"><meta name=description content="Gitosis and Gitweb – Part 1
So we are setup now thanks to Part 1.
Gitosis repository contents If we issue the “find .” command locally inside the …"><link rel=icon type=image/png href=/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicon-16x16.png sizes=16x16><link rel=stylesheet type=text/css media=screen href=/css/normalize.css><link rel=stylesheet type=text/css media=screen href=/css/main.css><link rel=stylesheet type=text/css media=screen href=/css/all.css><link rel=stylesheet href=/css/katex.css crossorigin=anonymous><script defer src=/js/katex.js integrity=sha384-HELAAZU8xvHgfT/8z4Mhmu+E2z3oBrMEuywaMh/CEd5uTZIDSct7TEaX+S43+dOi crossorigin=anonymous></script>
<script defer src=/js/auto-render.js integrity=sha384-0QrOZ8WIARJUoT5pH7Iuzi7iq0mXUXLF9yj5ZvYxTkMRv1zcaPQiOQ9ksHYbKw7M crossorigin=anonymous onload=renderMathInElement(document.body)></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><script>localStorage.setItem("theme","dark")</script><meta property="og:title" content="Gitosis and Gitweb - Part 2 - Add Projects and Contributors"><meta property="og:description" content="Gitosis and Gitweb – Part 1
So we are setup now thanks to Part 1.
Gitosis repository contents If we issue the “find .” command locally inside the gitosis-admin directory we will see the following:
~/gitosis-admin(master) > find . <a bunch of files from .git folder) ./gitosis.conf ./keydir ./keydir/user@local.pub We have the .git folder, a gitosis.conf file, and a keydir with a pub key file.
Add our first project Our project name for this example is lostechies."><meta property="og:type" content="article"><meta property="og:url" content="http://blog.jasonmeridth.com/posts/gitosis-and-gitweb-part-2/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2010-05-25T03:02:00-05:00"><meta property="article:modified_time" content="2010-05-25T03:02:00-05:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Gitosis and Gitweb - Part 2 - Add Projects and Contributors"><meta name=twitter:description content="Gitosis and Gitweb – Part 1
So we are setup now thanks to Part 1.
Gitosis repository contents If we issue the “find .” command locally inside the gitosis-admin directory we will see the following:
~/gitosis-admin(master) > find . <a bunch of files from .git folder) ./gitosis.conf ./keydir ./keydir/user@local.pub We have the .git folder, a gitosis.conf file, and a keydir with a pub key file.
Add our first project Our project name for this example is lostechies."><meta itemprop=name content="Gitosis and Gitweb - Part 2 - Add Projects and Contributors"><meta itemprop=description content="Gitosis and Gitweb – Part 1
So we are setup now thanks to Part 1.
Gitosis repository contents If we issue the “find .” command locally inside the gitosis-admin directory we will see the following:
~/gitosis-admin(master) > find . <a bunch of files from .git folder) ./gitosis.conf ./keydir ./keydir/user@local.pub We have the .git folder, a gitosis.conf file, and a keydir with a pub key file.
Add our first project Our project name for this example is lostechies."><meta itemprop=datePublished content="2010-05-25T03:02:00-05:00"><meta itemprop=dateModified content="2010-05-25T03:02:00-05:00"><meta itemprop=wordCount content="963"><meta itemprop=keywords content="git,gitosis,"></head><body><header><div id=avatar><a href=http://blog.jasonmeridth.com/><img src=/img/avatar.jpg alt="JM (Jason Meridth)"></a></div><div id=titletext><h2 id=title><a href=http://blog.jasonmeridth.com/>JM (Jason Meridth)</a></h2></div><div id=title-description><p id=subtitle>Learn, Converse, Share</p><div id=social><nav><ul><li><a href=https://github.com/jmeridth><i title=Github class="icons fab fa-github"></i></a></li><li><a href=mailto:jmeridth@gmail.com><i title=Email class="icons fas fa-envelope"></i></a></li><li><a href=https://linkedin.com/in/jmeridth><i title=LinkedIn class="icons fab fa-linkedin"></i></a></li><li><a href=/index.xml><i title=RSS class="icons fas fa-rss"></i></a></li><li><a><i title="Switch Dark Mode" class="dark-mode icons fas fa-moon"></i></a></li></ul></nav></div></div><div id=mainmenu><nav><ul><li><a href=/>Home</a></li><li><a href=/posts>All Posts</a></li><li><a href=/about>About</a></li><li><a href=/tags>Tags</a></li><li><a href=/categories>Categories</a></li></ul></nav></div></header><main><div class=post><article><div class=post-header><div class=meta><div class=date><span class=day>25</span>
<span class=rest>May 2010</span></div></div><div class=matter><h1 class=title>Gitosis and Gitweb - Part 2 - Add Projects and Contributors</h1><p class=post-meta><span class=post-meta>&nbsp;<i class="fas fa-clock"></i>&nbsp;5&nbsp;minutes
&nbsp;| &nbsp;
<i class="fas fa-book"></i>&nbsp;963&nbsp;words</span></p></div></div><div class=markdown><p><a href=/posts/gitosis-and-gitweb-part-1>Gitosis and Gitweb – Part 1</a></p><p>So we are setup now thanks to Part 1.</p><h2 id=gitosis-repository-contents>Gitosis repository contents</h2><p>If we issue the “find .” command locally inside the gitosis-admin directory we will see the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>~/gitosis-admin<span style=color:#f92672>(</span>master<span style=color:#f92672>)</span> &gt; find .
</span></span><span style=display:flex><span>&lt;a bunch of files from .git folder<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>./gitosis.conf
</span></span><span style=display:flex><span>./keydir
</span></span><span style=display:flex><span>./keydir/user@local.pub
</span></span></code></pre></div><p>We have the .git folder, a gitosis.conf file, and a keydir with a pub key file.</p><h2 id=add-our-first-project>Add our first project</h2><p>Our project name for this example is lostechies. If you view the gitosis-admin.conf file you will see the initial content like so:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>~/gitosis-admin<span style=color:#f92672>(</span>master<span style=color:#f92672>)</span> &gt; cat gitosis.conf
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>gitosis<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>group gitosis-admin<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>writable <span style=color:#f92672>=</span> gitosis-admin
</span></span><span style=display:flex><span>members <span style=color:#f92672>=</span> user@local
</span></span></code></pre></div><p>This is the result of the following command from the last part:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo -H -u git gitosis-init &lt; /tmp/id_rsa.pub
</span></span></code></pre></div><p>That command puts the public ssh key into the keydirs directory and adds the associated username from the file to be the first member of the gisotis-admin project. Hence seeing user@local as the member. It matches the filename of the pub file in the keydir directory (<a href=mailto:user@local.pub>user@local.pub</a>). That’s how gitosis relates members listed in the conf file to the keys in the keydir directory, filename minus the pub extension.</p><p>Let’s edit this conf file to include our lostechies project:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>~/gitosis-admin<span style=color:#f92672>(</span>master<span style=color:#f92672>)</span> &gt; cat gitosis.conf
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>gitosis<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>group gitosis-admin<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>writable <span style=color:#f92672>=</span> gitosis-admin
</span></span><span style=display:flex><span>memebers <span style=color:#f92672>=</span> user@local
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>group meridth<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>writable <span style=color:#f92672>=</span> meridth
</span></span><span style=display:flex><span>members <span style=color:#f92672>=</span> user@local
</span></span></code></pre></div><p>It looks exactly like the gitosis-admin one. Now we commit it just like we would normally when using Git. We can add, then commit or commit with the -am argument. This is possible since the gitosis-admin.conf file is already tracked by the repository.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>~/gitosis-admin<span style=color:#f92672>(</span>master<span style=color:#f92672>)</span> &gt; git commit -am <span style=color:#e6db74>&#34;add meridth project&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>master 6b7a5da<span style=color:#f92672>]</span> add meridth project
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> file changed, <span style=color:#ae81ff>3</span> insertions<span style=color:#f92672>(</span>+<span style=color:#f92672>)</span>, <span style=color:#ae81ff>0</span> deletions<span style=color:#f92672>(</span>-<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>and push it to the remote gitosis-admin repository:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>~/gitosis-admin<span style=color:#f92672>(</span>master<span style=color:#f92672>)</span> &gt; git push
</span></span><span style=display:flex><span>Counting objects: 5, <span style=color:#66d9ef>done</span>.
</span></span><span style=display:flex><span>Delta compression using up to <span style=color:#ae81ff>2</span> threads
</span></span><span style=display:flex><span>Compressing objects: 100% <span style=color:#f92672>(</span>3/3<span style=color:#f92672>)</span>, <span style=color:#66d9ef>done</span>.
</span></span><span style=display:flex><span>Writing objects: 100% <span style=color:#f92672>(</span>3/3<span style=color:#f92672>)</span>, <span style=color:#ae81ff>385</span> bytes, <span style=color:#66d9ef>done</span>.
</span></span><span style=display:flex><span>Total <span style=color:#ae81ff>3</span> <span style=color:#f92672>(</span>delta 0<span style=color:#f92672>)</span>, reused <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>delta 0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>To git@YOUR_SERVER_HOSTNAME:gitosis-admin.git
</span></span><span style=display:flex><span>   23842e9..6b7a5da master -&gt; master
</span></span></code></pre></div><p>We need to create the lostechies repository locally, add an initial item (README in this case), and push it remotely. Gitosis won’t create the repository until something it pushed to it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>START HERE
</span></span></code></pre></div><p>The lostechies repository now exists remotely. Currently my account is the only that has access. Let’s add another contributor.</p><h2 id=add-our-first-contributors>Add our first contributors</h2><p>Say I want to allow my friend Joe to have commit (writable) access to my lostechies repository and I want my friend Ryan to only have readonly access. I tell them to send me their public ssh keys. I make sure the files are named joe.pub and ryan.pub. I then put them into my local gitosis-admin repository’s keydir directory and then I edit the gitosis.conf file to be:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>~/gitosis-admin<span style=color:#f92672>(</span>master<span style=color:#f92672>)</span> &gt; cp ~/joe.pub keydir/ <span style=color:#f92672>&amp;&amp;</span> cp ~/ryan.pub keydir/
</span></span><span style=display:flex><span>~/gitosis-admin<span style=color:#f92672>(</span>master<span style=color:#f92672>)</span> &gt; vim gitosis.conf
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>gitosis<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>group gitosis-admin<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>writable <span style=color:#f92672>=</span> gitosis-admin
</span></span><span style=display:flex><span>members <span style=color:#f92672>=</span> user@local
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>group lostechies<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>writable <span style=color:#f92672>=</span> lostechies
</span></span><span style=display:flex><span>members <span style=color:#f92672>=</span> user@local joe
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>group lostechies_ro<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>readonly <span style=color:#f92672>=</span> lostechies
</span></span><span style=display:flex><span>members <span style=color:#f92672>=</span> ryan
</span></span></code></pre></div><p>Notice that I had to create a whole new group (lostechies_ro) to setup Ryan’s readonly access. You can’t combine readonly and writable permissions in gitosis (wish we could – open source contribution there?).</p><p>Now I need to “git add” the new keys, and commit the changes to the conf file. Finally I push the changes.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>~/gitosis-admin<span style=color:#f92672>(</span>master<span style=color:#f92672>)</span> &gt; git add keydir/joe.pub keydir/ryan.pub
</span></span><span style=display:flex><span>~/gitosis-admin<span style=color:#f92672>(</span>master<span style=color:#f92672>)</span> &gt; git commit -am <span style=color:#e6db74>&#34;add joe and ryan and give them access to lostechies repository&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>master 3fb193c<span style=color:#f92672>]</span> add joe and ryan and give them access to lostechies repository
</span></span><span style=display:flex><span> <span style=color:#ae81ff>3</span> files changed, <span style=color:#ae81ff>6</span> insertions<span style=color:#f92672>(</span>+<span style=color:#f92672>)</span>, <span style=color:#ae81ff>1</span> deletions<span style=color:#f92672>(</span>-<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span> create mode <span style=color:#ae81ff>100644</span> keydir/joe.pub
</span></span><span style=display:flex><span> create mode <span style=color:#ae81ff>100644</span> keydir/ryan.pub
</span></span><span style=display:flex><span>~/gitosis-admin<span style=color:#f92672>(</span>master<span style=color:#f92672>)</span> &gt; git push
</span></span><span style=display:flex><span>Counting objects: 7, <span style=color:#66d9ef>done</span>.
</span></span><span style=display:flex><span>Delta compression using up to <span style=color:#ae81ff>2</span> threads.
</span></span><span style=display:flex><span>Compressing objects: 100% <span style=color:#f92672>(</span>4/4<span style=color:#f92672>)</span>, <span style=color:#66d9ef>done</span>.
</span></span><span style=display:flex><span>Writing objects: 100% <span style=color:#f92672>(</span>4/4<span style=color:#f92672>)</span>, <span style=color:#ae81ff>470</span> bytes, <span style=color:#66d9ef>done</span>.
</span></span><span style=display:flex><span>Total <span style=color:#ae81ff>4</span> <span style=color:#f92672>(</span>delta 1<span style=color:#f92672>)</span>, reused <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>delta 0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>To git@YOUR_SERVER_HOSTNAME: gitosis-admin.git
</span></span><span style=display:flex><span>   20148cf..efb193c master -&gt; master
</span></span></code></pre></div><p>Now Joe or Ryan can clone this repository:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone git@YOUR_SERVER_HOSTNAME:lostechies.git
</span></span></code></pre></div><p><em><strong>NOTE:</strong></em> Again, if they receive the following error:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>~ &gt; git clone git@YOUR_SERVER_HOSTNAME:gitosis-admin.git
</span></span><span style=display:flex><span>Initialized empty Git repository in /Users/user/gitosis-admin/.git/
</span></span><span style=display:flex><span>ssh: connect to host YOUR_SERVER_HOSTNAME port 22: Connection refused
</span></span><span style=display:flex><span>fatal: The remote end hung up unexpectedly
</span></span></code></pre></div><p>The solution, involving the .ssh/config file is in the first post in this series.</p><p>That is how you create a repository and add users.</p><h2 id=debug>DEBUG</h2><p>If you are unable to connect you have the option of editing the gitosis.conf file with more message verbosity by adding “loglevel=DEBUG” at the top of the conf file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>~/gitosis-admin<span style=color:#f92672>(</span>master<span style=color:#f92672>)</span> &gt; vim gitosis.conf
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>gitosis<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>loglevel<span style=color:#f92672>=</span>DEBUG
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>This will give you more information on the ouput when trying to push to the remote repository.</p><h2 id=cant-push-changes>Can’t push changes</h2><p>As Scott Chacon states in his gitosis section of <a href=http://progit.org/book/ch4-7.html target=_blank>Pro Git</a>:</p><blockquote><p>“If you’ve lost push access by pushing a messed-up configuration, you can manually fix the file on the server under /home/git/.gitosis.conf — the file from which Gitosis reads its info. A push to the project takes the gitosis.conf file you just pushed up and sticks it there. If you edit that file manually, it remains like that until the next successful push to the gitosis-admin project.”</p></blockquote><p>The .gitosis.conf file in the git user’s home directory is a symlink to the actual conf file in the gitosis-admin repository:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>lrwxrwxrwx <span style=color:#ae81ff>1</span> git  git  <span style=color:#ae81ff>53</span> May <span style=color:#ae81ff>22</span> 20:32 .gitosis.conf -&gt; /home/git/repositories/gitosis-admin.git/gitosis.conf
</span></span></code></pre></div><p>Next Part: <a href=/posts/gitosis-and-gitweb-part-3>Gitosis and Gitweb Part 3</a></p><h2 id=comments>Comments</h2><p><strong><a href=#478 title="2010-05-25 12:51:54">Gabriel N. Schenker</a>:</strong> your post come in handy; just at the right time! Very nicely done, thanks</p><p><strong><a href=#479 title="2010-07-24 22:06:27">colvertlyn</a>:</strong> permafrost expected action cover <a href=http://gravity.wikia.com target=_blank>million per absolute broadly</a> [url=<a href=http://www.skyandtelescope.com target=_blank>http://www.skyandtelescope.com</a>]emission small glacial observational[/url] <a href=http://www.nal.usda.gov target=_blank>http://www.nal.usda.gov</a></p><p><strong><a href=#480 title="2010-07-24 22:06:47">salfordwil</a>:</strong> volunteer physical llc</p><p><strong><a href=#481 title="2010-08-21 08:53:11">ashlynnega</a>:</strong> increased link <a href=http://www.unesco.org target=_blank>rise sectors windows past</a> [url=<a href=http://water.usgs.gov target=_blank>http://water.usgs.gov</a>]videos comment president android[/url] <a href=http://www.newswire.ca target=_blank>http://www.newswire.ca</a></p><p><strong><a href=#482 title="2010-08-21 08:53:28">garrmankor</a>:</strong> economy regions hypothesis special</p><p><strong><a href=#496 title="2011-05-12 10:24:00">Mullins</a>:</strong> After creating the losttechies repository locally I needed to create the remote &lsquo;origin&rsquo; by executing: $ git remote add origin <a href=mailto:git@MYSERVER.com>git@MYSERVER.com</a>:losttechies.git</p></div><div class=tags><div class=taxosfloating_left><p>Tags</p></div><div class=termsfloating_right><p><a href=/tags/git/>git</a>
<a href=/tags/gitosis/>gitosis</a></p></div><div class=clearit></div></div></article></div></main><footer>© Copyright notice | <a href=https://github.com/dataCobra/hugo-vitae target=_blank>Vitae</a> theme for <a href=https://gohugo.io target=_blank>Hugo</a>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-38456568-3","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></footer><script src=/js/dark-mode.js></script></body></html>