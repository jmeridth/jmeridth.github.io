<!doctype html><html lang=en><head><title>Gitosis and Gitweb - Part 3 · Learn, Converse, Share</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Jason Meridth"><meta name=description content="Gitosis and Gitweb – Part 1
Gitosis and Gitweb – Part 2
So we are setup, have a project, and have contributors via the first 2 parts.
I know that we are all enamored by the UI of GitHub.com. I am. Unfortunately you can’t get private repositories for free (In all fairness it’s only $7/mo. – a very wise investment). I am aware of Gitorious like I mentioned in the first part, but I have no experience with that. I will after this series and update this series if I find it better. Again, I like to use the simplest thing that works. (Of course, “simplest” is in the eye of the beholder)"><meta name=keywords content="jason meridth,meridth,jm,software developer"><meta name=fediverse:creator content><meta name=twitter:card content="summary"><meta name=twitter:title content="Gitosis and Gitweb - Part 3"><meta name=twitter:description content="Gitosis and Gitweb – Part 1
Gitosis and Gitweb – Part 2
So we are setup, have a project, and have contributors via the first 2 parts.
I know that we are all enamored by the UI of GitHub.com. I am. Unfortunately you can’t get private repositories for free (In all fairness it’s only $7/mo. – a very wise investment). I am aware of Gitorious like I mentioned in the first part, but I have no experience with that. I will after this series and update this series if I find it better. Again, I like to use the simplest thing that works. (Of course, “simplest” is in the eye of the beholder)"><meta property="og:url" content="http://jmeridth.com/posts/gitosis-and-gitweb-part-3/"><meta property="og:site_name" content="Learn, Converse, Share"><meta property="og:title" content="Gitosis and Gitweb - Part 3"><meta property="og:description" content="Gitosis and Gitweb – Part 1
Gitosis and Gitweb – Part 2
So we are setup, have a project, and have contributors via the first 2 parts.
I know that we are all enamored by the UI of GitHub.com. I am. Unfortunately you can’t get private repositories for free (In all fairness it’s only $7/mo. – a very wise investment). I am aware of Gitorious like I mentioned in the first part, but I have no experience with that. I will after this series and update this series if I find it better. Again, I like to use the simplest thing that works. (Of course, “simplest” is in the eye of the beholder)"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2010-05-26T04:45:00-05:00"><meta property="article:modified_time" content="2010-05-26T04:45:00-05:00"><meta property="article:tag" content="Git"><meta property="article:tag" content="Gitosis"><link rel=canonical href=http://jmeridth.com/posts/gitosis-and-gitweb-part-3/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.aa5ef26fa979d6793724ae2dbd71efa94fd16cb1c5c7db3b6651f21f9892a5fd.css integrity="sha256-ql7yb6l51nk3JK4tvXHvqU/RbLHFx9s7ZlHyH5iSpf0=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/css_dark_mode_gist_embed_code.min.5f4f026828cc544c1497785bca628b4ddc8a6c1f154cc2b83c87a13ceaff419a.css integrity="sha256-X08CaCjMVEwUl3hbymKLTdyKbB8VTMK4PIehPOr/QZo=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/favicon.ico sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-dark"><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=http://jmeridth.com/>Learn, Converse, Share
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=/projects/>Projects</a></li><li class=navigation-item><a class=navigation-link href=/talks/>Talks</a></li><li class=navigation-item><a class=navigation-link href=/contact/>Contact Me</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=http://jmeridth.com/posts/gitosis-and-gitweb-part-3/>Gitosis and Gitweb - Part 3</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2010-05-26T04:45:00-05:00>May 26, 2010
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
5-minute read</span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/git/>Git</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/gitosis/>Gitosis</a></span></div></div></header><div class=post-content><p><a href=/posts/gitosis-and-gitweb-part-1>Gitosis and Gitweb – Part 1</a></p><p><a href=/posts/gitosis-and-gitweb-part-2>Gitosis and Gitweb – Part 2</a></p><p>So we are setup, have a project, and have contributors via the first 2 parts.</p><p>I know that we are all enamored by the UI of <a href=http://github.com class=external-link target=_blank rel=noopener>GitHub.com</a>. I am. Unfortunately you can’t get private repositories for free (In all fairness it’s only $7/mo. – a <em>very</em> wise investment). I am aware of <a href=http://gitorious.com class=external-link target=_blank rel=noopener>Gitorious</a> like I mentioned in the first part, but I have no experience with that. I will after this series and update this series if I find it better. Again, I like to use the simplest thing that works. (Of course, “simplest” is in the eye of the beholder)</p><p>In this section I’m going to show you how to install Gitweb, a UI tool that let’s you view your repositories. I’m also going to mention how to get it to auto-detect any new repositories and ensure they show up on the web UI. I learned how to do most of this from my co-worker <a href=http://twitter.com/ajmesserli class=external-link target=_blank rel=noopener>Antony Messerli</a>. He is a true Linux and problem-solving Jedi.</p><h2 id=install-apache>Install Apache
<a class=heading-link href=#install-apache><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>First, you need to ensure apache2 is installed. Check to see if you have an /etc/apache2 folder. If you do, you should be okay. If you don’t, you need to install it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt-get install apache2
</span></span></code></pre></div><p>For more in-depth advice, I always reference the <a href=http://articles.slicehost.com/2010/5/19/installing-apache-on-ubuntu class=external-link target=_blank rel=noopener>Slicehost Articles</a></p><p>Once you have that installed the daemon restarted, go to your slices ip address in the browser of your choice (i.e,. <a href=http://123.123.123.123 class=external-link target=_blank rel=noopener>http://123.123.123.123</a>) and you should something like “It Works”</p><p>Voila! You have apache running.</p><h2 id=install-the-package>Install the Package
<a class=heading-link href=#install-the-package><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt-get install gitweb
</span></span></code></pre></div><p>This will install gitweb into /var/www/gitweb, create a conf file at /etc/gitweb.conf, and add three files to /usr/share/gitweb (git-favicon.png, git-logo.png, gitweb.css).</p><p>Note: If for some reason, the /var/www/gitweb folder <em>is not</em> created, you can clone the git source (git clone git://git.kernel.org/pub/scm/git/git.git) and then just copy the git/gitweb folder to /var/www/gitweb</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cp -R git/gitweb /var/www/
</span></span></code></pre></div><p>You only need to edit the $projectroot variable in the /etc/gitweb.conf to point to your gitosis repositories folder:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># path to git projects (&lt;project&gt;.git)</span>
</span></span><span class=line><span class=cl><span class=nv>$projectroot</span> <span class=o>=</span> <span class=s2>&#34;/home/git/repositories&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><p>Since this isn’t a post about Apache, I just add the gitweb directory setup to the base Apache config. Since Ubuntu includes the entire /etc/apache2/conf.d directory, I just added the following information into /etc/apach2/conf.d/gitweb:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>RewriteEngine on
</span></span><span class=line><span class=cl>RewriteRule ^/gitweb/<span class=o>([</span>a-zA-Z0-9_<span class=se>\-</span><span class=o>]</span>+<span class=se>\.</span>git<span class=o>)</span>/?<span class=o>(</span><span class=se>\?</span>.*<span class=o>)</span>?$ /cgi-bin/gitweb.cgi/<span class=nv>$1</span> <span class=o>[</span>L,PT<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Alias /gitweb /home/git/repositories
</span></span><span class=line><span class=cl>&lt;Directory /home/git/repositories&gt;
</span></span><span class=line><span class=cl>Options Indexes FollowSymlinks ExecCGI
</span></span><span class=line><span class=cl>DirectoryIndex /cgi-bin/gitweb.cgi
</span></span><span class=line><span class=cl>AllowOverride None
</span></span><span class=line><span class=cl>&lt;/Directory&gt;
</span></span></code></pre></div><p>Restart Apache to make sure everything works</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo /etc/init.d/apache2 restart
</span></span></code></pre></div><p>The first time you go to your website again, you’ll see Gitweb, but it’ll say no projects are available. Fix mentioned below.</p><h3 id=two-hacks-open-to-suggestions>Two Hacks (open to suggestions)
<a class=heading-link href=#two-hacks-open-to-suggestions><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>1. I had to copy the git-favicon.png, git-logo.png, gitweb.css files from /usr/share/gitweb to /var/www/gitweb/. (if you had to do what is mentioned in the Note above, you don’t have to do this, since the gitweb folder from the git source clone includes these files already)</p><p>2. I had to make the repositories that I wanted visible in gitweb have permissions of 755 (aka owner has read, write, execute. group and others have read, execute.)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo chmod -R <span class=m>755</span> /git/repositories/lostechies.git
</span></span></code></pre></div><p>Once that was done I can see the repository and it’s information on Gitweb.</p><p><img src=/img/gitweb-part3.png alt></p><p>If you want to edit the project description from &ldquo;Unnamed repository; edit this file &lsquo;description&rsquo; to name the repository.&rdquo; go to the repositories description file (/home/git/repositories/          lostechies.git/description for this repo) and edit the file and save.</p><h3 id=cron-job>Cron job
<a class=heading-link href=#cron-job><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>I, again with the leadership of Ant, utilized a cron job he wrote to automatically make the repositories have permissions of 755. I do have some repositories, like gitosis-admin, that I do not ever want visible on Gitweb. The cron job excludes them. Here is the cron job code, showing that I don’t want to show my personal.git and gitosis-admin.git repositories. This could be easily written in Ruby or any other “scripting language” of your choice:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/sh
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=nv>GITOSIS_REPO_PATH</span><span class=o>=</span><span class=s2>&#34;/home/git/repositories&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>GITOSIS_ADMIN_PATH</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$GITOSIS_REPO_PATH</span><span class=s2>/gitosis-admin.git&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>PERSON_REPO_PATH</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$GITOSIS_REPO_PATH</span><span class=s2>/personal.git&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>debug <span class=o>()</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;[D]: </span><span class=nv>$1</span><span class=s2>&#34;</span> &gt; /dev/null
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> dir in <span class=sb>`</span>find <span class=nv>$GITOSIS_REPO_PATH</span> -maxdepth <span class=m>1</span> -mindepth <span class=m>1</span> -type d<span class=sb>`</span><span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$dir</span><span class=s2>&#34;</span> !<span class=o>=</span> <span class=s2>&#34;</span><span class=nv>$GITOSIS_ADMIN_PATH</span><span class=s2>&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$dir</span><span class=s2>&#34;</span> !<span class=o>=</span> <span class=s2>&#34;</span><span class=nv>$PERSON_REPO_PATH</span><span class=s2>&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>             <span class=sb>`</span>chmod -R <span class=m>0755</span> <span class=nv>$dir</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>        <span class=k>fi</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl>    debug <span class=s2>&#34;All repositories have permissions set to 0755&#34;</span>
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span></code></pre></div><p>I chose bash, so that I could take that time to learn it.
Translation: Find all the directories in my gitosis repository path (/home/git/repositories) and if they are not gitosis-admin or personal, change their permissions, recursively, to 0755.</p><p>I put this in a file called set_gitosis_permissions_to_view_on_gitweb.sh and put it in root’s home folder, /root. I then called the file from root’s crontab:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>~ /&gt; sudo su -
</span></span><span class=line><span class=cl><span class=c1># /root &gt; crontab -e</span>
</span></span><span class=line><span class=cl><span class=c1># m h dom mon dow  command</span>
</span></span><span class=line><span class=cl>*/5 * * * * /root/set_gitosis_permissions_to_view_on_gitweb.sh
</span></span></code></pre></div><p>This means that every 5 minutes, my bash file will set any new repositories to 0755. This is how to get Gitweb stood up. The next post will show how to hide it behind HTTP basic auth and a self-signed certificate.</p><p>Next Part: Hiding the Gitweb site</p><h2 id=comments>Comments
<a class=heading-link href=#comments><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p><strong><a href=#483 title="2010-07-09 22:07:08">katy lavallee</a>:</strong> Anxiously awaiting the next part :)</p><p><strong><a href=#513 title="2011-11-05 01:16:00">Thorpe</a>:</strong> You said you chose Bash so that you could take some time to learn it. Unfortunately however, your shebang points to sh not bash. There is some differences.</p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2007 -
2025
Jason Meridth
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-4W46VMK7DQ"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4W46VMK7DQ")</script></body></html>